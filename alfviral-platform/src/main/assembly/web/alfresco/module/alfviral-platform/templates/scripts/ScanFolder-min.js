function ScanFolder(b,a){logger.log("============");logger.log(" ScanFolder ");logger.log("============");logger.log("Scanning from: "+b.replace(companyhome.name+"/",""));logger.log("Â¿Recursive? "+(a.equals("r")?"Si":"No"));scanFolderRun(b,a)}function scanFolderRun(e,b){var d=false;var a=companyhome.children;if(e.replace(companyhome.name,"").length>0){a=companyhome.childByNamePath(e.replace(companyhome.name+"/","")).children}if(a){for(var c in a){if(a[c].isDocument){logger.log("Escaneando: "+a[c].displayPath+"/"+a[c].name);actions.create("alfviral.virusscan.action").execute(a[c])}else{if(a[c].isContainer&&b=="r"){logger.log("Entrando en: "+a[c].displayPath+"/"+a[c].name);scanFolderRun(a[c].displayPath+"/"+a[c].name,"r")}}}d=true}else{logger.log("No se ha encontrado la carpeta para escanear.")}return d};